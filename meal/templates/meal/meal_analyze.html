{% extends 'base.html' %}

{% block content %}
<main>
    <section class="meal-analysis">
        <h1>식단 사진을 업로드 해주세요.</h1>
        <!-- <div class="meal_content"> -->
            <form method="post" enctype="multipart/form-data" action="{% url 'meal_to_analyze' %}" onsubmit="return photoUploadCheck()">
                {% csrf_token %}
                <label for="fileUpload">식단 사진 선택:</label>
                <input type="file" id="fileUpload" name="fileUpload" accept="image/*">
                <div id="preview">
                    <p>AI가 식단을 분석해 자동으로 영양정보를 분석하고 맞춤 식단을 추천해드립니다.</p>
                    <div id="time_comment"></div>
                </div>
                <button type="submit" id="analyze-button">분석</button>
            </form>
        <!-- </div> -->
    </section>
    <div id="current-section"></div>
    <!-- <section class="meal-details">
        <h2>식단 정보</h2>
        <div id="meal_detail"></div>
    </section>
    </div> -->
</main>
<aside>
    <div id="analysis-section">
        <main>
            <p>업로드 한 식사를 분석하고 있습니다</p>
        </main>
    </div>

    <!-- <h2>영양소 정보</h2>
    <div id="nutrient_information"></div> -->
    <!-- <h2>코멘트</h2> -->
</aside>
<script>
    // 사진 업로드 체크. 이 함수 없으면 오류 발생
    function photoUploadCheck() {
        var fileUpload = document.getElementById('fileUpload');

        if (fileUpload.files.length == 0) {
            alert('사진을 업로드해주세요');
            return false;
        }
        return true;
    };

    // 시간별 코멘트
    function updateComment() {
        var now = new Date();
        var hours = now.getHours();
        var basecomment = '';
        var commentText = '';

        if (hours >= 6 && hours <= 9) {
            // 아침 시간대 (6시-9시)
            commentText = '아침 식사가 중요합니다! 오늘 하루도 활기차게 시작하세요.';
        } else if (hours >= 11 && hours <= 14) {
            // 점심 시간대 (11시-14시)
            commentText = '점심 시간입니다! 균형 잡힌 식사로 에너지를 충전하세요.';
        } else if (hours >= 18 && hours <= 20) {
            // 저녁 시간대 (18시-20시)
            commentText = '저녁 시간이네요. 하루를 마무리하는 든든한 식사를 즐기세요.';
        } else {
            // 그 외
            commentText = '식사 시간이 아닙니다. 건강한 간식을 섭취해 보세요!';
        }

        document.getElementById('time_comment').textContent = commentText;
    };
    updateComment()
</script>
{% endblock content %}